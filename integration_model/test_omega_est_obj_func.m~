function test_omega_est_obj_func


fprintf(' ------ Steepest descent with Armijo rule step size -------\n');
[iter, f1, x1, t1] = GradientDescent1(Q,b,x0);
fprintf('iteration: %d \n', iter);
fprintf('distance from convergent point: %d \n', norm(x1(end) - x_opt));

figure(1)
plot(abs(f1 - y_opt)/abs(y_opt))
title('Steepest descent with Armijo rule: Objective function');

end

% Finding Armijo stepsize
function [m,x1] = ArmijoUpdate(sigma, beta, x0)
    dx = dobj_func(Q,b,x0);  %%% <---- Change the gradient function right here
    m = 0;
    x1 = x0 - beta^m * dx;
    % dropping value bounded above by linear prediction
    while(obj_func(Q,b,x0) - obj_func(Q,b,x1) <= sigma*beta^m*norm(dx)^2)        
        m = m + 1;        
        x1 = x0 - beta^m * dx;
        % fprintf('diff f: %f \n',f(Q,b,x0) - f(Q,b,x1)); 
        % fprintf('size step: %f \n',sigma*beta^m*norm(dx)^2); 
    end
end

% Using steepest descent with Armijo rule
function [iter, f_obj, x_1, time] = GradientDescent1(q_kk, q_k, x0)
    sigma = 0.1; beta = 0.3;
    x_1 = zeros(length(x0), 100);
    tic;
    x_1(:,1) = x0;    
    f_obj(1) = obj_func(q_kk, q_k ,x_1(:,1));
    [~, x_1(:,2)] = ArmijoUpdate(sigma, beta, Q, b, x_1(:,1));
    f_obj(2) = f(Q,b,x_1(:,2));
    iter = 1;
    time(iter) = toc;
    while( norm(x_1(:,iter+1) - x_1(:,iter))/norm(x_1(:,iter)) > 0.01 ||...
           abs(obj_func(q_kk, q_k, x_1(:,iter+1)) - obj_func(q_kk, q_k, x_1(:,iter)))/abs(obj_func(q_kk, q_k, x_1(:,iter))) > 1e-2 )        
        tic;
        iter = iter + 1;
        [~, x_1(:,iter+1)] = ArmijoUpdate(sigma, beta, q_kk, q_k, x_1(:,iter));
        f_obj(iter+1) = obj_func(q_kk, q_k, x_1(:,iter+1));
        time(iter) = toc;
        % fprintf('norm x: %f \n',norm(x_1(:,iter+1) - x_1(:,iter))/norm(x_1(:,iter)));
        % fprintf('norm f: %f \n',abs(f(Q,b,x_1(:,iter+1)) - f(Q,b,x_1(:,iter)))/abs(f(Q,b,x_1(:,iter)))); 
        % fprintf('f: %f \n',f(Q,b,x_1(:,iter+1))); 
    end    
end